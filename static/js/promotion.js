promotions = [
    {
      id: 1,
      type: "sport",
      title: "សមាជិកថ្មីថែម 100%",
      description: `ចុះឈ្មោះដំបូងទទួលបានទឹកប្រាក់ស្វាគមន៍ 100% លក្ខខណ្ឌនៃការផ្តល់រង្វាន់
      ដាក់ប្រាក់តិចបំផុត 10 ដុល្លា
      ប្រាក់រង្វាន់បន្ថែម 100%
      ប្រាក់រង្វាន់ផ្ដល់ច្រើនបំផុត 50 ដុល្លារ (សម្រាប់តែអតិថិជនដំបូងប៉ុណ្ណោះ)
      ដើម្បីចូលរួមជាមួយកម្មវិធី : ដាក់ប្រាក់តាមរយៈធនាគារ,ទាមទារនូវទឹកប្រាក់បន្ថែម។ ទឹកប្រាក់បន្ថែមតម្រូវឲ្យលេងចំនួន 15ជុំ ឧទាហរណ៍ ÷ ដាក់ប្រាក់ចំនួន : 50$ ទឹកប្រាក់បន្ថែម : 50$ របៀបភ្នាល់វិលជុំ : 50$+50$*15ជុំ= 1500$ទឹកប្រាក់ភ្នាល់ (ការភ្នាល់ដែលមានហាងឆេងទាបជាង 1.60 (Decimal) រឺ (malay odds 0.50; HK odds 0.60; Indo Odds -2.00) មិនរាប់បញ្ចូល (បាល់ឆានឹងបាល់ស្មើមិនត្រូវរាប់បញ្ចូលក្នុងការវិលជុំ)
      សុពលភាព ផ្តលជូនចាបពីថ្ងៃទី ១ ខែមីនា រហូតដល់ ថ្ងៃទី ៣០ ខែមីនា ឆ្នាំ ២០២៤ ។ 
      2MWiN រក្សាសិទ្ធិគ្រប់យ៉ាង (បុគ្គលមួយរូបមានសិទ្ធិប្រើគណនេយ្យតែមួយប៉ុណ្ណោះ)
      សូមទាក់ទងទៅកាន់ផ្នែកសេវាកម្មអតិថជន Tell : 093 566 222 - 095 566 222  `,
      image: "./static/assets/images/promotions/promotion1.jpg"
    },
    {
      id: 2,
      type: "keno",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion2.jpg"
    },
    {
      id: 3,
      type: "sport",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion3.jpg"
    },
    {
      id: 4,
      type: "cock",
      title: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      description: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      image: "./static/assets/images/promotions/promotion4.jpg"
    },
    {
      id: 5,
      type: "casino",
      title: "សមាជិកថ្មីថែម 100%",
      description: "សមាជិកថ្មីថែម 100%",
      image: "./static/assets/images/promotions/promotion5.jpg"
    },
    {
      id: 6,
      type: "cock",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion6.jpg"
    },
    {
      id: 7,
      type: "sport",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion7.jpg"
    },
    {
      id: 8,
      type: "keno",
      title: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      description: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      image: "./static/assets/images/promotions/promotion8.jpg"
    },
    {
      id: 9,
      type: "cock",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion6.jpg"
    },
    {
      id: 10,
      type: "sport",
      title: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      description: "ប្រាក់បង្វិលប្រចាំអាទិត្យ 5%",
      image: "./static/assets/images/promotions/promotion7.jpg"
    },
    {
      id: 11,
      type: "keno",
      title: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      description: "ណែនាំសមាជិកថ្មីទទួលបាន 5% រៀងរាល់ថ្ងៃ",
      image: "./static/assets/images/promotions/promotion8.jpg"
    },
];

const paginationContainer = document.querySelector('.pagination-container');

// Set number of items per page
let currentPage = 1;
const itemsPerPage = 9;

let currentFilteredPromotions = []; 

const renderPaginationControls = (totalItems) => {
  const totalPages = Math.ceil(totalItems / itemsPerPage);
  paginationContainer.innerHTML = `
      <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''} class="btn-change-page">
          <i class="fa fa-angle-left"></i> Prev
      </button>
      <button class="active">${currentPage}</button>
      <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''} class="btn-change-page">
          Next <i class="fa fa-angle-right"></i>
      </button>
  `;
};

const changePage = (page) => {
    const totalPages = Math.ceil(currentFilteredPromotions.length / itemsPerPage);
    if (page < 1 || page > totalPages) {
        return;
    }
    currentPage = page;
    renderPromotions(currentFilteredPromotions);
};

function renderPromotions(filteredPromotions) {
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const promotionWrapper = document.querySelector('.promotion-wrapper');
    promotionWrapper.innerHTML = ""; // Clear the container

    // Slice the promotions to the current page
    const currentPromotions = filteredPromotions.slice(start, end);

    currentPromotions.forEach(promotion => {
        const promotionCard = document.createElement('div');
        promotionCard.classList.add('promotion');
        promotionCard.innerHTML = `
            <img src="${promotion.image}" alt="${promotion.title}">
            <h4 class="promotion-title">${promotion.title}</h4>
        `;

        promotionCard.dataset.title = promotion.title;
        promotionCard.dataset.description = promotion.description;
        promotionCard.dataset.image = promotion.image;

        promotionCard.addEventListener("click", () => {
            popupPromotionModal(promotionCard); // Popup modal with promotion data
            toggleModal(true); // Open modal
        });
        promotionWrapper.appendChild(promotionCard);
    });

    // Render pagination controls
    paginationContainer.style.display = filteredPromotions.length > itemsPerPage ? "flex" : "none";
    renderPaginationControls(filteredPromotions.length);
}

function filterPromotions(type) {
    // Filter promotions based on the type
    currentFilteredPromotions = type === 'all'
        ? promotions
        : promotions.filter(promotion => promotion.type === type);

    // Update active menu
    document.querySelectorAll('.promotion-menu').forEach(menu => menu.classList.remove('active'));
    document.querySelector(`.promotion-menu[onclick="filterPromotions('${type}')"]`).classList.add('active');

    // Reset to the first page
    currentPage = 1;

    // Render filtered promotions
    renderPromotions(currentFilteredPromotions);
}

// Initialize with all promotions
currentFilteredPromotions = promotions;
renderPromotions(currentFilteredPromotions);

//Promotion Popup modal
const popupPromotionModal = (card) => {
    const promotionId = document.querySelector('.promotion-id');
    const promotionImage = document.querySelector('.promotion-image');
    const promotionDescription = document.querySelector('.promotion-description');

    // Access data attributes from the clicked card
    const cardTitle = card.dataset.title;
    const cardDescription = card.dataset.description;
    const cardImage = card.dataset.image;

    // Set modal content
    promotionImage.src = cardImage;
    promotionDescription.textContent = cardDescription;
    promotionId.textContent = cardTitle;
};

const modal = document.querySelector('.modal');
const btnCloseModal = document.querySelectorAll('.close-modal');

// toggle modal visibility
const toggleModal = (isVisible) => {
    modal.style.display = isVisible ? "block" : "none";
};

// Buttons for closing modal
btnCloseModal.forEach((btn) => {
    btn.addEventListener("click", () => toggleModal(false));
});

// Close modal when clicking outside of the modal content
modal.addEventListener("click", (e) => {
    if (e.target === modal) {
        toggleModal(false);
    }
});